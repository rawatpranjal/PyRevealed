--- Page 1 ---
CHAPTER 3
Rational Demand
Revealed preference theory started out as an exploration into the testable
implications of neoclassical demand theory, and while it has expanded in
many different directions, the analysis of rational demand is the most actively
researched area in revealed preference theory. In this chapter, we present an
exposition of the basic results in the revealed preference theory of rational
demand.
We suppose here that we have observations on the purchasing decisions of
a single consumer. The consumer makes a sequence of independent choices at
different price vectors. The data consists of the consumerâ€™s choices, and we
seek to understand the implications of rational consumption behavior for such
data.
The material on rational demand is divided into three chapters. In Chapter 3
we discuss the basic results on weak and strong rationalization, including
Afriatâ€™s Theorem, the main result in the revealed preference theory of rational
demand. In Chapter 4 we turn to speciï¬c properties of demand functions; and
in Chapter 5 to some of the practical issues that arise when applying the results
of revealed preference theory to empirical research.
3.1
WEAK RATIONALIZATION
Consider an agent choosing a bundle of n goods to purchase. Consumption
space is X âŠ†Rn
+, meaning that the consumer chooses x âˆˆX. We assume that
for any x âˆˆX and Îµ > 0, there is Îµâ€² with 0 < Îµâ€² < Îµ and x + Îµâ€²1 âˆˆX; this means
that it is possible to add more of every good to any bundle in X and still remain
in X.1
Given a preference relation âª°on X, let d : Rn
++ Ã— R+ â†’2X be the demand
correspondence associated to âª°; it is deï¬ned as
d(p,m) = {x âˆˆX : p Â· x â‰¤m and (âˆ€y âˆˆX)(y â‰»x â‡’p Â· y > m)}.
1 This assumption is used to guarantee the existence of locally nonsatiated rationalizations.


--- Page 2 ---
3.1 Weak rationalization
35
We refer to d as a demand function if d(p,m) is always a singleton.
A consumption dataset D is a collection (xk,pk), k = 1,...K, with K â‰¥1
an integer, xk âˆˆX and pk âˆˆRn
++. For each k, xk is the consumption bundle
purchased by the consumer at prices pk. We shall assume that the consumer
exhausts all his income, so that the expenditure pk Â· xk is also the total income
devoted to consumption at the time at which the purchases were made. This
assumption is in principle unavoidable, because if we were to allow for unspent
(and unobservable) income, then any dataset is rationalizable. Section 3.2.3
discusses some related issues. As we shall see, the assumption that income
equals expenditure amounts to an implicit assumption of local nonsatiation.
We seek to understand when the consumerâ€™s behavior is compatible with
the basic theory of rational choice. Formally, a preference relation âª°weakly
rationalizes a consumption dataset D if, for all k and y âˆˆX, pkÂ·xk â‰¥pkÂ·y implies
that xk âª°y. In other words, if d is the demand correspondence associated to âª°,
then âª°weakly rationalizes D if xk âˆˆd(pk,pk Â·xk) for all k. Say that D is weakly
rationalizable if there is a preference relation that weakly rationalizes D. There
is a stronger version of rationalizability, which we shall discuss in Section 3.2.
We often specify a preference relation through a utility function. Say that a
utility u : X â†’R weakly rationalizes the data if for all k and y âˆˆX, pk Â·xk â‰¥pk Â·y
implies that u(xk) â‰¥u(y).
If we place no restrictions on âª°, then any dataset is weakly rationalizable.
We can just let âª°indicate indifference among all the elements of X. The
resulting theory is not very interesting or useful: it explains everything because
it predicts nothing. For this reason, we are going to impose some basic
discipline on our exercise by requiring that the rationalizing âª°be monotonic.
Consider the situation in Figure 3.1. The ï¬gure illustrates a dataset D0 =
{(x1,p1),(x2,p2)}. The bundle x2 is affordable at a budget in which x1 was
demanded. If the consumer were rational we could infer that she likes x1 at
least as much as x2: we say that x1 is revealed preferred to x2. At the same time,
x2 is revealed preferred to x1. We would conclude that a rational consumer who
made these choices would regard x1 and x2 as equally good. Any rationalizing
preference must impose indifference between x1 and x2.
Now we see that if the rationalizing preference is required to be monotone,
then indifference is impossible. When the consumer in Figure 3.1 purchased x1,
she could have chosen x2 by spending strictly less than she did at x1. We should
then conclude that she cannot regard the two choices as exactly equivalent: the
consumer could have afforded a bundle xâˆ—â‰«x2 at prices p1 and expenditure
p1 Â· x1. By monotonicity of the rationalizing preference, the bundle xâˆ—must be
strictly preferred to x2. At the same time, x1 must be at least as good as xâˆ—. So
xâˆ—must be strictly preferred to x2; the consumer cannot be indifferent between
the two. We infer that the observations in Figure 3.1 constitute a refutation of
the hypothesis that the consumer is rational and his preferences are monotonic.
Generally, we say that a consumption dataset D satisï¬es the weak axiom of
revealed preference (WARP) if there is no pair of observations (xk,pk) and
(xl,pl) such that pk Â· xk â‰¥pk Â· xl while pl Â· xl > pl Â· xk. In words, there is no pair


--- Page 3 ---
36
Rational Demand
p2
p1
x1
x2
Fig. 3.1 A violation of WARP.
of observations such that the ï¬rst is revealed preferred to the second, while
the second is strictly revealed preferred to the ï¬rst. The dataset in Figure 3.1
exhibits a violation of WARP (recall the discussion of WARP in 2.1.1).
To go beyond the example in Figure 3.1 it is useful to introduce some general
deï¬nitions.
Given a consumption dataset D = {(xk,pk)}K
k=1, we can deï¬ne an order pair
âŸ¨âª°R,â‰»RâŸ©on X by x âª°R y iff there is k such that x = xk and pk Â· xk â‰¥pk Â· y; and
x â‰»R y iff there is k such that x = xk and pk Â· xk > pk Â· y. Note that â‰»R âŠ†âª°R,
but that â‰»R will typically not be the strict binary relation associated to âª°R.2
The pair âŸ¨âª°R,â‰»RâŸ©is Dâ€™s revealed preference pair. A dataset satisï¬es WARP
iff there is no x,y âˆˆX with x âª°R y and y â‰»R x.
Revealed preference pairs, as we have just deï¬ned them, are special cases of
the notions introduced in Section 2.3 of Chapter 2. The primitives in Chapter 2
are: a set X, a collection of subsets  âŠ†2X\{âˆ…}, and a choice function c :
 â†’2X\{âˆ…} such that for all B âˆˆ, c(B) âŠ†B. Here, X âŠ†Rn
+ is our given
consumption space; the collection  of budget sets is deï¬ned as  = {Bk},
where Bk = {y âˆˆX : pk Â·xk â‰¥pk Â·y}; and c(B) = {xk : Bk = B}. Then the notion
of revealed preference order pair coincides with the deï¬nition in Chapter 2, and
the deï¬nition of WARP we have just given is equivalent to that of Chapter 2.
Observe that the relations âª°R and â‰»R are typically very incomplete, in
the sense that many alternatives in X are not comparable according to these
relations; the problem of rationalizability can be viewed as the problem of
completing (or extending) these relations in a way that preserves transitivity.
We saw in the discussion of Figure 3.1 that WARP is necessary for weak
rationalization by a monotonic preference. It will be shown below that WARP
is not sufï¬cient. The (stronger) property that is both necessary and sufï¬cient
for weak rationalization by a monotonic preference is deï¬ned as follows:
2 This property of âŸ¨âª°R,â‰»RâŸ©is in fact why we introduced the notion of order pairs.


--- Page 4 ---
3.1 Weak rationalization
37
A dataset satisï¬es the generalized axiom of revealed preference (GARP) if
its revealed preference pair is an acyclic order pair. Note that the requirement
that âŸ¨âª°R,â‰»RâŸ©is an order pair implies that â‰»R must be asymmetric. We also say
that the revealed preference order pair satisï¬es GARP. Again, the concept of
GARP corresponds to the deï¬nition in 2.3.
Deï¬ne the indirect revealed preference relation to be the binary relation
(âª°R)T, the transitive closure of âª°R. In that sense, we can think of âª°R as
a direct revealed preference relation, and of â‰»R as a direct strict revealed
preference relation. Thus, one equivalent way to phrase GARP is to say that if x
is indirectly revealed preferred to y, then y cannot be revealed strictly preferred
to x.
GARP is also equivalent to the following property. For any sequence of data
points ((xk1,pk1),...,(xkL,pkL)), if the following inequalities hold:
pk1 Â· xk1 â‰¥pk1 Â· xk2
pk2 Â· xk2 â‰¥pk2 Â· xk3
...
pkLâˆ’1 Â· xkLâˆ’1 â‰¥pkLâˆ’1 Â· xkL
pkL Â· xkL â‰¥pkL Â· xk1,
then they must hold with equality.
Theorem 3.1
A dataset is weakly rationalizable by a monotonic preference
relation iff its revealed preference pair satisï¬es GARP.
With the identiï¬cation made above between the primitives of this chapter
and those of Chapter 2, Theorem 3.1 is easily seen to be a special case of
Theorem 2.19. Simply verify that the conditions of Theorem 2.19 are satisï¬ed;
namely, 1) that each Bk is comprehensive with respect to the natural ordering
âŸ¨â‰¥,>âŸ©; and 2) that x â‰»R y iff x âª°R y and there exists k with x,y,z âˆˆBk x âˆˆc(Bk)
and z > y. In fact, because all prices are strictly positive, the same properties
hold with respect to the order pair âŸ¨â‰¥,â‰«âŸ©.
Remark 3.2
The proof of Theorem 3.1 reveals a bit more than stated: GARP
implies the existence of a strictly monotone rationalizing preference. Thus
monotonicity and strict monotonicity are observationally equivalent. Further,
we can impose local nonsatiation on our rationalizing preference. In that case,
the existence of a locally nonsatiated weak rationalization implies GARP. So
local nonsatiation and strict monotonicity are observationally equivalent.
Remark 3.3
When the consumption space is discrete, say it is Zn
+, then
Theorem 3.1 must be modiï¬ed. In this environment it is possible that pk Â· xl <
pk Â·xk but there is no x âˆˆZN
+ for which xl < x and pk Â·x â‰¤pk Â·xk. For example, if
n = 2, this occurs with the two-observation consumption dataset speciï¬ed by
(x1,p1) = ((1,2),(4,3)) and (x2,p2) = ((2,0),(5,2)). This consumption dataset


--- Page 5 ---
38
Rational Demand
pk
xk+1
xk+1
xk+2
xk
xk
Î»
Î»1
Î»2
xl
xl lies below Î», then xk > R xl.
xk+2 to the right of xk+1.
(a) 
(b) 
Fig. 3.2 An illustration of the proof of Theorem 3.4.
is weakly rationalizable by a strictly monotonic preference, yet p1 Â·x2 < p1 Â·x1
and p2 Â·x1 < p2 Â·x2. The issue is that the notion xk â‰»R xl as deï¬ned in Chapter 2
does not coincide with pk Â· xl < pk Â· xk in this case.
The importance of the difference between WARP and GARP is brought out by
our next results, Theorem 3.4 and Remark 3.5.
Theorem 3.4
Suppose that there are exactly two goods (n = 2). Then a
dataset satisï¬es GARP if and only if it satisï¬es WARP.
Proof. We show that if a consumption dataset D fails GARP, then there must
exist a cycle of length two. To this end, we will argue by contradiction and
consider a cycle of minimal length, supposing that it has length at least three.
The proof is geometric.
Suppose then that (x1,p1),...,(xL,pL) is a sequence of observations in D that
imply a violation of GARP. So they form a cycle C:
x1 âª°R x2 âª°R Â·Â·Â· âª°R xL â‰»R x1,
with L â‰¥3. Suppose, toward a contradiction, that there are no shorter cycles.
We ï¬rst show that no observed bundle is larger than another. Suppose to
the contrary that xk â‰¥xl for k Ì¸= l. Working with indices modulo L, xkâˆ’1 âª°R xk
would then imply xkâˆ’1 âª°R xl, for pkâˆ’1 Â·xkâˆ’1 â‰¥pkâˆ’1 Â·xk â‰¥pkâˆ’1 Â·xl. Then we may
remove xk, . . . , xlâˆ’1 from the cycle to form one of shorter length, retaining the
strict inequality if it lies in this part of the cycle â€“ a contradiction, as C was
minimal.
So suppose that no observed bundle is larger than another. Since n = 2, the
observed bundles can be ordered by the quantity of good 1 consumed in each
bundle.
The basic observation is the following. Let xk be a bundle in C. Consider the
half-line in R2
+ starting from xk and passing through xk+1. See Figure 3.2(a).
The half-line, named Î» in the ï¬gure, will lie wholly within the budget at which


--- Page 6 ---
3.1 Weak rationalization
39
xk was purchased. So if xl is on or below the half-line, then xk âª°R xl. And
xk â‰»R xl when xk â‰»R xk+1, or when xl is strictly below Î».
Now suppose that xk has more of good 1 than xk+1, so xk+1 lies to the left
of xk. Consider xk+2, a bundle distinct from xk and xk+1. Let Î»1 be the half-line
starting from xk and passing through xk+1, and Î»2 be the half-line starting from
xk+1 and passing through xk+2. Note that xk+2 cannot lie strictly below Î»1, or
we would obtain xk â‰»R xk+2 and a shorter cycle than C.
We shall prove that xk+2 must be to the left of xk+1. Suppose, toward a
contradiction, that xk+2 has more of good 1 than xk+1; so it lies to the right,
as in Figure 3.2(b). If xk were strictly below Î»2, we would have the cycle
of length two xk âª°R xk+1 â‰»R xk. So the only possibility is that xk lies on
Î»2. Thus xk, xk+1, and xk+2 are all on the same line. But this conï¬guration
always leads to a shorter cycle than C, because it implies that xk âª°R xk+1 âª°R xk
and that xk âª°R xk+2. Thus, if xk â‰»R xk+1, or if xk+1 â‰»R xk+2 (which implies
xk+1 â‰»R xk), then there is a shorter cycle â€“ in fact a cycle of length two. And
if Â¬(xk â‰»R xk+1) and Â¬(xk+1 â‰»R xk+2) then the strict comparison in C lies
elsewhere, so xk âª°R xk+2 leads to a shorter cycle. Thus xk+2 must be to the
left of xk+1.
The argument we have just made says that whenever xk+1 lies to the left of
xk, xk+2 must lie to the left of xk+1. Now, C is a cycle, so (1) there is some k
such that xk+1 is to the left of xk; and (2) it cannot be true that xk+1 is to the left
of xk for all k. We are left with a contradiction.
Remark 3.5
Theorem 3.4 fails dramatically when n â‰¥3. For each k there is
an example of a dataset that is not weakly rationalizable, but that has no cycles
of length less than k. Hence, when n â‰¥3 there is no hope of simplifying GARP
to some axiom that would only require ruling out cycles of certain lengths.
Consider the set {x âˆˆR3
+ : 
i xi = 1}. Draw on the face of this set a
regular, convex polygon with k vertices (a regular k-gon). The vertices of the
polygon will be the demand observations (these are vectors in R3
+). One needs
to construct prices which result in a cycle of length k, but no shorter cycle.
Consider going clockwise around the polygon. Any vertex, say observation xj,
has an adjacent vertex xj+1 (connected by an edge) in the clockwise direction.
It is clear that one can separate the convex hull {xj,xj+1} from the convex
hull of {xi}k
i=1\{xj,xj+1}. In fact, by a simple continuity argument, we can
pick a hyperplane with normal vector qj such that xj lies on the hyperplane,
qj Â· xj+1 < qj Â· xj, and for all i Ì¸âˆˆ{j,j + 1}, qj Â· xi > qj Â· xj. Then for Î± small
enough, pj = Î±qj + (1,...,1) will be a vector of strictly positive prices for
which pj Â· xj+1 < pj Â· xj, and for all i Ì¸âˆˆ{j,j + 1}, pj Â· xi > pj Â· xj (recall that

l=1,2,3 xi
l = 1 for all i). This gives a cycle of length k, but of no shorter length.
Theorem 3.1 answers the question of which datasets are weakly rationalizable.
As we observed in Remark 3.2, consumption datasets cannot distinguish
between a locally nonsatiated and a strictly monotonic preference relation.
It turns out that much more can be said about the possible rationalizing


--- Page 7 ---
40
Rational Demand
preference relation: the following remarkable result says that the hypotheses of
rationalization via a concave, strictly increasing, and continuous utility func-
tion are empirically indistinguishable from the hypothesis of rationalization
via a locally non-satiated preference.
Afriatâ€™s Theorem
Let X be a convex consumption space, and D =
{(xk,pk)}K
k=1 be a consumption dataset. The following statements are equiv-
alent:
I) D has a locally non-satiated weak rationalization;
II) D satisï¬es GARP;
III) There are strictly positive real numbers Uk and Î»k, for each k, such
that
Uk â‰¤Ul + Î»lpl Â· (xk âˆ’xl)
for each pair of observations (xk,pk) and (xl,pl) in D;
IV) D has a continuous, concave, and strictly monotonic rationalization
u : X â†’R.
The inequalities in Statement III of Afriatâ€™s Theorem are called Afriat
inequalities.
Remark 3.6
We can replace the system of inequalities in (III) by a smaller
system, which only requires the inequalities to hold for k and l for which
pl Â· (xk âˆ’xl) â‰¤0. This fact is evident from the proof of the theorem in 3.1.1.
Before we give the proof, it is useful to interpret (III), the Afriat inequalities.
The inequalities come from the ï¬rst-order conditions for the maximization of
a utility function subject to a budget set: Suppose for simplicity that the data
is rationalizable by a utility function u that is differentiable. The ï¬rst order
condition would demand that
âˆ‡u(x)|x=xk = Î»kpk,
where Î»k is a Lagrange multiplier. If, in addition, the utility function is concave
we know that u(y) âˆ’u(x) â‰¤âˆ‡u(x) Â· (y âˆ’x) (see Proposition 1.11). By letting
Uk = u(xk), one obtains the Afriat inequality
Uk âˆ’Ul = u(xk) âˆ’u(xl) â‰¤âˆ‡u(xl) Â· (xk âˆ’xl) = Î»lpl Â· (xk âˆ’xl).
It should then be clear that Afriat inequalities have two sources. One is
satisfaction of the ï¬rst-order condition for the consumerâ€™s problem. The other
is the concavity of the utility function. The numbers Uk in (III) are meant to
be the utility levels achieved when consuming xk, and Î»k is meant to be the
Lagrange multiplier.
What is remarkable about Afriatâ€™s Theorem is that GARP is sufï¬cient to
ensure a solution to this system of inequalities. The idea that GARP captures
rationalizability (Theorems 2.19 and 3.1) is relatively easy to see. The result
that concavity comes for free is deeper.


--- Page 8 ---
3.1 Weak rationalization
41
p1
p2
x1
x2
x2
x1
A dataset satisfying WARP.
Indifference curves for Afriatâ€™s utility.
(a)
(b)
Fig. 3.3 An illustration of the utility function in Afriatâ€™s Theorem.
Given a solution to the system of inequalities (III), one can write down a
rationalizing utility function that satisï¬es the conditions in (IV):
u(x) = min{Uk + Î»kpk Â· (x âˆ’xk) : k = 1,...,K}.
This utility function is illustrated in Figure 3.3. On the left, in Figure 3.3(a) is a
dataset satisfying WARP. On the right are indifference curves corresponding to
the utility function deï¬ned, as above, from solutions to the Afriat inequalities
for that dataset.
One last comment is in order. The utility we have just exhibited is not
smooth (for a result on smooth utility, see Section 3.2.1); but we made use
of smoothness when we introduced the ï¬rst-order conditions. Smoothness is
not crucial to the argument. The important concept is that Î»kpk must be a
supergradient of the utility function. It is instructive to see why this is the
case.
Assume given a solution to the Afriat inequalities. We can then string
together Afriat inequalities as follows: Uk âˆ’Ul â‰¤Î»lpl Â·(xk âˆ’xl) and Um âˆ’Uk â‰¤
Î»kpk Â· (xm âˆ’xk) imply that
Um âˆ’Ul â‰¤Î»lpl Â· (xk âˆ’xl) + Î»kpk Â· (xm âˆ’xk).
In fact, if we consider a sequence k1,k2,...kL, and kL = k1, then
0 =
Lâˆ’1

i=1
(Uki+1 âˆ’Uki) â‰¤
Lâˆ’1

i=1
Î»kipki Â· (xki+1 âˆ’xki).
The property we have just derived from a solution to the Afriat inequalities
is, in the terminology of 1.4, that the correspondence Ï(x) = 
k:x=xk{Î»kpk} is
cyclically monotone (on its domain). Then, reasoning as in Theorem 1.9 (and
Corollary 1.10), one obtains a rationalizing utility.
In other words, one way of understanding Afriatâ€™s Theorem is as providing
numbers Î»k for which the correspondence Ï(x) = 
k:x=xk{Î»kpk} is cyclically
monotone. In that sense, GARP can be viewed as an ordinal version of cyclic
monotonicity.


--- Page 9 ---
42
Rational Demand
Remark 3.7
One may similarly ask whether the existence of Î»k > 0 for
which Ï(x) = 
k:x=xk{Î»kpk} satisï¬es monotonicity is equivalent to WARP.
Unfortunately it is not. An example is as follows. Let p1 = (1,0,0), x1 =
(3,3,3), p2 = (0,1,0), x2 = (2,2,5), p3 = (0,0,1), and x3 = (4,0,4). It is easily
veriï¬ed that this consumption dataset satisï¬es WARP, and that there are no
corresponding Î»k leading to a satisfaction of monotonicity. Prices can also be
chosen strictly positive.
We offer two different proofs of Afriatâ€™s Theorem.
3.1.1
Proof of Afriatâ€™s Theorem
We prove that (I) â‡’(II) â‡’(III) â‡’(IV) â‡’(I). That (I) â‡’(II) follows
from Theorem 3.1. That (IV) â‡’(I) is obvious. We shall prove the other
implications, starting from (II) â‡’(III), which is the substance of this proof.
The proof uses the Theorem of the Alternative, in the form of Lemma 1.12.
We shall prove that if there is no solution to the system of linear inequalities
in (III), then GARP is violated. Using Lemma 1.12 it is easy to formulate
the consequences of the inequalities not having a solution. We ignore the
requirement that each Ui > 0, as any solution to the remaining inequalities
can be made to satisfy this simply by adding a large enough constant to each
Ui. We need to specify the matrix B that corresponds to these linear inequalities
in a helpful way.
Consider all pairs (i,j) âˆˆ{1,...,K}2 with i Ì¸= j, and call this set of pairs A.
We now construct a real-valued matrix of dimension (|A| + K) Ã— 2K. The ï¬rst
|A| rows are indexed by elements of A, and the last K by {1,...,K}. The ï¬rst
K columns are labeled 1,...,K, while the second K are labeled 1â€²,...,Kâ€². The
construction of the matrix is illustrated below.
â¡
â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
1
Â·Â·Â·
i
Â·Â·Â·
j
Â·Â·Â·
K
1â€²
Â·Â·Â·
iâ€²
Â·Â·Â·
Kâ€²
(1,2)
1
Â·Â·Â·
0
Â·Â·Â·
0
Â·Â·Â·
0
p1 Â· (x2 âˆ’x1)
Â·Â·Â·
0
Â·Â·Â·
0
...
...
...
...
...
...
...
...
(i,j)
0
Â·Â·Â·
1
Â·Â·Â·
âˆ’1
Â·Â·Â·
0
0
Â·Â·Â·
pi Â· (xj âˆ’xi)
Â·Â·Â·
0
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
i
0
Â·Â·Â·
0
Â·Â·Â·
0
Â·Â·Â·
0
0
Â·Â·Â·
1
Â·Â·Â·
0
...
...
...
...
...
...
...
...
â¤
â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
Deï¬ne the matrix B as follows: For the ï¬rst |A| rows, in the row
corresponding to (i,j), we put zeroes in all entries except for 1 in column i,
âˆ’1 in column j, and pi Â· (xj âˆ’xi) in column iâ€². We can write this succinctly
by denoting a vector of all zeroes with a single 1 in its ith entry by 1i. Then
row (i,j) is the vector 1i âˆ’1j + pi Â· (xj âˆ’xi)1iâ€². For the last K rows, in the row


--- Page 10 ---
3.1 Weak rationalization
43
corresponding to i, we put the vector 1iâ€². Clearly, a vector
(U,Î») = (U1,...,UK,Î»1,...,Î»K)
satisï¬es the system of inequalities in (III) iff B(i,j) Â· (U,Î») â‰¥0, for all (i,j) âˆˆA,
and Bi Â· (U,Î») > 0 for all i.
By Lemma 1.12, the nonexistence of a solution to Afriatâ€™s inequalities
means that there is for each (i,j) a Î·(i,j) â‰¥0 and for each h âˆˆ{1,...,K} a Î·h â‰¥0
such that

(i,j)âˆˆA
Î·(i,j)B(i,j) +
K

h=1
Î·hBh = 0,
(3.1)
and
Î·h > 0
for at least one 1 â‰¤h â‰¤K.
(3.2)
Out of all Î· = (Î·(i,j),Î·h) satisfying (3.1) and (3.2), choose Î· to have a minimum
number of entries that equal zero. Think of the numbers Î·(i,j) and Î·h as weights.
So Lemma 1.12 gives a weighted sum of rows that is identically zero, and
where the weight is strictly positive for at least one of the last K rows of the
matrix.
Let i be such that Î·i > 0 as in (3.2). The weighted sum of entries in column
iâ€² is zero, so there must exist a pair (i,j) for which pi Â·(xj âˆ’xi) < 0 and Î·(i,j) > 0.
Then we have a positive weight on âˆ’1 in the column for j. So there must exist
some k with Î·(j,k) > 0. Then, writing the sum of entries in column jâ€²,
0 = Î·j +

(j,k)
Î·(j,k)pj Â· (xk âˆ’xj) = Î·j +

(j,k)
Î·(j,k)>0
Î·(j,k)pj Â· (xk âˆ’xj).
Since Î·j â‰¥0, it follows that there be some index k such that pj Â·(xk âˆ’xj) â‰¤0 in
addition to Î·(j,k) > 0.
We therefore see that xi â‰»R xj âª°R xk. In fact, what we proved above is the
implication
Î·(i,j) > 0 â‡’there exists k such that

Î·(j,k) > 0 and xj âª°R xk
;
(3.3)
therefore, continuing in this fashion we obtain a cycle
xi1 âª°R Â·Â·Â· âª°R xiL âª°R xiL+1 = xi1
as the set {xk}K
1 is ï¬nite.
There are two possibilities. Either xia â‰»R xia+1 for at least one a, or pia Â·
(xia+1 âˆ’xia) = 0 for all a. In the former case âŸ¨âª°R,â‰»RâŸ©is not acyclic, so the data
violate GARP and we are done.
In the latter case, we show that we can transform the weights Î· to
obtain new weights Î·â€² such that Î·â€²
(ia,ia+1) = 0 for at least one (ia,ia+1) with
pia Â· (xia+1 âˆ’xia) = 0. Note that, because xi1,xi2,...,xiL,xi1 is a cycle, and


--- Page 11 ---
44
Rational Demand
pia Â· (xia+1 âˆ’xia) = 0, we have that
L

a=1

(1ia âˆ’1ia+1) + pia Â· (xia+1 âˆ’xia)1iâ€²a

= 0.
By construction (3.3) above, Î·(ia,ia+1) > 0 for each 1 â‰¤a â‰¤L, so set
Îº = min
a=1,...,LÎ·(ia,ia+1)
and consider
Î·â€²
(i,j) =

Î·(i,j) âˆ’Îº
if âˆƒa : (ia,ia+1) = (i,j)
Î·(i,j)
otherwise,
and Î·â€²
i = Î·i for all i. Then,

(i,j)âˆˆA
Î·â€²
(i,j)B(i,j) +
K

i=1
Î·â€²
iBi =

(i,j)âˆˆA
Î·(i,j)B(i,j) +
K

i=1
Î·iBi
âˆ’Îº
 L

a=1
(1ia âˆ’1ia+1) + pia Â· (xia+1 âˆ’xia)1iâ€²a

= 0.
Note
that
Î·â€²
equals
zero
for
at
least
one
(ia+1,ia)
such
that
pia Â· (xia+1 âˆ’xia) = 0 (the ones with minimum weight in Î·).
Therefore, Î·â€² â‰¥0 is also a vector that satisï¬es Equations (3.1) and (3.2),
Î·â€² â‰¤Î·, and Î·â€² has at least one entry = 0 that Î· does not have. This is not
possible, as Î· was chosen to contain the minimal number of zeros. Thus, it
must be the case xia â‰»R xia+1 for some 1 â‰¤a â‰¤L, which proves (II) â‡’(III).
To prove that (III) implies (IV), deï¬ne a utility function u : X â†’R by
u(x) = min{Uk + Î»kpk Â· (x âˆ’xk) : k = 1,...,K}.
Observe that u is the minimum of continuous, monotone increasing, and con-
cave (linear) functions, and hence is itself continuous, monotone increasing,
and concave.
It is easy to see that u is a weak rationalization. First, u(xk) = Uk for all k,
as (III) implies that Uk = Uk +Î»kpk Â·(xk âˆ’xk) â‰¤Ul +Î»lpl Â·(xk âˆ’xl). Second, ï¬x
an observation k and let y be such that pk Â·xk â‰¥pk Â·y. We have that u(xk) â‰¥u(y)
because
u(xk) = Uk â‰¥Uk + Î»kpk Â· (y âˆ’xk) â‰¥u(y).
Thus the preference represented by u is a weak rationalization of the data.
â–¡
3.1.2
Constructive proof of Afriatâ€™s Theorem
The substantive step in the proof of Afriatâ€™s Theorem is the implication (II)
â‡’(III). The proof we have given in 3.1.1 relies on Lemma 1.12, and has


--- Page 12 ---
3.1 Weak rationalization
45
the advantage of illustrating a method that we use repeatedly in this book (see
for instance Chapter 12; or Theorems 3.8 and 3.12 in the present chapter). We
now turn to a proof that shows how one constructs numbers Uk and Î»k that
solve the inequalities in (III). This proof has the advantage of giving a way of
constructing a rationalizing utility by constructively ï¬nding a solution to the
Afriat inequalities.3
Let X0 âŠ†X be the set of observed consumption bundles; that is, X0 = {xk :
k = 1,...,K}. Consider the revealed preference pair âŸ¨âª°R,â‰»RâŸ©restricted to X0.
By Theorem 1.5, GARP implies that there is a preference relation âª°on X0
such that x âª°y when x âª°R y and x â‰»y when x â‰»R y. Partition X0 according to
the equivalence classes of âª°. That is, let I1,...,IJ be a partition of X0 such that
x âˆ¼y for x,y âˆˆIj and x â‰»y if x âˆˆIj, y âˆˆIh, and j > h.4
There are two important aspects of the partition I1,...,IJ. First, if xk,xl âˆˆIj
then pl Â· (xk âˆ’xl) â‰¥0 and pk Â· (xl âˆ’xk) â‰¥0; as pk Â· (xl âˆ’xk) < 0, for example,
would imply that xk â‰»R xl and thus xk â‰»xl. Second, if xk âˆˆIj, xl âˆˆIh and h < j,
then pl Â· (xk âˆ’xl) > 0; as pl Â· (xk âˆ’xl) â‰¤0 would imply that xl âª°R xk and thus
xl âª°xk.
We now deï¬ne (Uk,Î»k)K
k=1 recursively. Set Uk = Î»k = 1 if xk âˆˆIJ.
Suppose that we have deï¬ned (Uk,Î»k) for all xk âˆˆJ
h=j+1 Ih. We can choose
Vj such that, for all xl âˆˆIj and xk âˆˆJ
h=j+1 Ih,
Vj < Uk
and
Vj < Uk + Î»kpk Â· (xl âˆ’xk).
(3.4)
Set Ul = Vj for all l with xl âˆˆIj.
Note that the choice of Ul ensures that if xk âˆˆJ
h=j+1 Ih then Ul < Uk. Since
pl Â· (xk âˆ’xl) > 0 for each xl âˆˆIj, we can choose Î»l to be
Î»l = max
k
Uk âˆ’Ul
pl Â· (xk âˆ’xl) â‰¥0
(3.5)
where the max is taken over k such that xk âˆˆJ
h=j+1 Ih.
The chosen (Uk,Î»k)K
k=1 satisfy the inequalities in (III). Indeed, let k and l be
such that xk âˆˆIj, xl âˆˆIh and j > h. Then (3.4) ensures that
Ul â‰¤Uk + Î»kpk Â· (xl âˆ’xk),
and (3.5) that
Uk â‰¤Ul + Î»lpl Â· (xk âˆ’xl).
(3.6)
If k and l are such that xk,xl âˆˆIj, then Uk = Ul so (3.6) follows because Î»k > 0
and pl Â· (xk âˆ’xl) â‰¥0.
3 It should also be mentioned that linear programming methods, applied to the linear system in
the proof in 3.1.1, can also be used to construct a solution to the Afriat inequalities.
4 Strictly speaking, the existence of âª°is not constructive, as Theorem 1.5 relies on Zornâ€™s
Lemma. In the present case, however, X0 is ï¬nite and âª°is easily constructed.


--- Page 13 ---
46
Rational Demand
3.1.3
General budget sets
We turn to a version of Afriatâ€™s Theorem for general budget sets, budget sets
that may not be deï¬ned by a vector of prices. We can generalize the statement
pk Â· (x âˆ’xk) â‰¤0, specifying when x is affordable at prices pk, by introducing a
monotonic, continuous function gk : X â†’R for which gk(xk) = 0. We say that
x is affordable when gk(x) â‰¤0.
A dataset is now a collection (xk,Bk),k = 1,...,K; where for each k there is
a monotonic and continuous function gk : X â†’R such that Bk = {z âˆˆX : gk(z) â‰¤
0}. We suppose that gk(xk) = 0. Note that our previous notion of a dataset is a
special case, where for each k, gk(x) = pk Â· (x âˆ’xk).
Adapting the deï¬nitions of revealed preference, we can deï¬ne x âª°R y when
there is k such that x = xk and gk(y) â‰¤0; and x â‰»R y when there is k such that
x = xk and gk(y) < 0. A dataset satisï¬es GARP if âŸ¨âª°R,â‰»RâŸ©is an acyclic order
pair. A dataset satisï¬es WARP if x âª°R y implies that y â‰»R x does not hold.
In this more general environment, WARP and GARP are no longer
equivalent when n = 2. Consider the three points (0,3),(2,2),(3,0). For any
pair of these, the convex and comprehensive hull of that pair does not include
the third. We can choose our gk functions so that there are three budget sets,
the convex and comprehensive hulls of the pairs. It is then easy to construct a
violation of GARP for which there is no corresponding violation of WARP.
The following generalization of Afriatâ€™s Theorem is due to Forges and
Minelli.
Theorem 3.8
Let X be convex. The following are equivalent:
I) The
data
{(xk,Bk)}K
k=1
have
a
locally
nonsatiated
weak
rationalization;
II) âŸ¨âª°R,â‰»RâŸ©is acyclic;
III) There are strictly positive real numbers Uk and Î»k, for each k, such
that
Ul â‰¤Uk + Î»kgk(xl)
for each pair of observations k and l.
IV) The
data
{(Bk,xk)}K
k=1
have
a
monotonic
and
continuous
rationalization;
Further, in the case when all the functions gk are concave, the statements
above are equivalent to the existence of a monotonic, continuous, and concave
rationalization.
Proof. First, that (IV) â‡’(I) â‡’(II) is immediate. The substance of the
proof is (II) â‡’(III), just as in the proof of Afriatâ€™s Theorem. The proof
follows along the same lines as our proof of Afriatâ€™s Theorem.
To prove that (II) â‡’(III), construct a matrix B as follows. Let A be the
set of pairs (k,l) with k Ì¸= l. For the ï¬rst |A| rows, in the row corresponding to
(k,l), we put 1k âˆ’1l + gk(xl)1kâ€². For the last K rows, in the row corresponding


--- Page 14 ---
3.2 Strong rationalization
47
to k, we put the vector 1kâ€². A vector
(U,Î») = (U1,...,UK,Î»1,...,Î»K)
satisï¬es the system of inequalities in (III) iff B(k,l) Â·(U,Î») â‰¥0, for all (k,l) âˆˆA,
and Bk Â· (U,Î») > 0 for all k.
Suppose that there is no solution to the system in (III). By Lemma 1.12 there
is Î· â‰¥0 such that

(k,l)âˆˆA
Î·(k,l)B(k,l) +

k
Î·kBk = 0,
and Î·k > 0 for at least one k. Choose Î· to have the least number of zero entries.
Reasoning just as in the proof of Afriatâ€™s Theorem, we know that there is l
for which Î·(k,l) > 0 and gk(xl) < 0. The negative entry in the column for l in
row (k,l) must cancel out with some row (w,l) with strictly positive weight in
Î·; in fact w can be chosen such that gl(xw) â‰¤0. Thus xk â‰»R xl âª°R xw. The rest
of the proof is analogous to the proof of Afriatâ€™s Theorem: we obtain a cycle
of âŸ¨âª°R,â‰»RâŸ©.
To prove that (III) â‡’(IV) we use a similar construction to the one in
Afriatâ€™s Theorem; we let
u(x) = min{Uk + Î»kgk(x) : k = 1,...,K}.
Note that u is monotone increasing and continuous. In addition, if gk(y) â‰¤0
then u(y) â‰¤Uk = u(xk); so it is a weak rationalization.
Finally, the construction above is concave when each gk is concave.
3.2
STRONG RATIONALIZATION
A preference relation âª°strongly rationalizes a consumption dataset D if, for
all k and y âˆˆX,
(pk Â· y â‰¤pk Â· xk and y Ì¸= xk) â‡’xk â‰»y
Say that D is strongly rationalizable if there is a preference relation that
strongly rationalizes D. Note that this deï¬nition implies choice must be
single-valued, which is not the case for the notion of strong rationalization
presented in 2.1. Otherwise, the deï¬nition of strong rationalization here is
consistent with that in 2.1 under the assumption of single-valued choice.
Recall that one can understand weak rationalization as the extension of
the observed demand behavior to a demand correspondence, namely the
demand correspondence generated by the rationalizing preference. In contrast,
strong rationalization is about extending the observed demand behavior to a
(single-valued) demand function. In particular, the dataset {(x1,p1),(x2,p2)},
with p1 = p2, x1 Ì¸= x2, and p1 Â· x1 = p2 Â· x2, is weakly rationalizable by
a preference that is indifferent among x1 and x2, but it is not strongly
rationalizable as it is incompatible with a single-valued demand function.


--- Page 15 ---
48
Rational Demand
Given a consumption dataset D, we can deï¬ne an order pair âŸ¨âª°S,â‰»SâŸ©by
x âª°S y iff there is k such that x = xk and pk Â·xk â‰¥pk Â·y; and x â‰»S y iff x âª°S y and
x Ì¸= y. The pair âŸ¨âª°S,â‰»SâŸ©is Dâ€™s strong revealed preference pair.
A dataset satisï¬es the strong axiom of revealed preference (SARP) if its
strong revealed preference pair is acyclic.
Theorem 3.9
A dataset is strongly rationalizable iff it satisï¬es SARP.
Remark 3.10
The rationalization can, in fact, be assumed to be strictly
monotonic, as in Theorem 3.1. Since we are considering strong rationalization,
there is no need to impose monotonicity or local nonsatiation to rule out a
trivial rationalization.
Proof. Let D be a dataset that satisï¬es SARP. We can deï¬ne âŸ¨RM,PMâŸ©from
âŸ¨âª°S,â‰»SâŸ©as RM= âª°S âˆªâ‰¥and PM= â‰»S âˆª>. Then the proof of the following
lemma is similar to the proof of Theorem 2.19, and therefore omitted.
Lemma 3.11
If âŸ¨âª°S,â‰»SâŸ©satisï¬es SARP then âŸ¨RM,PMâŸ©is acyclic.
Now the proof follows from Theorem 1.5.
The next result is in the spirit of Afriatâ€™s Theorem. It shows that if we insist on
a strong rationalization, then strict concavity is observationally equivalent to
local nonsatiation. Note that strict concavity is trivially testable in the context
of weak rationalization, as strict concavity (indeed strict quasiconcavity) of
the utility function implies that demand is single valued. It turns out that
strict concavity adds no additional empirical content to the hypothesis of
single-valued demand.
Theorem 3.12
Let X be a convex consumption space, and D = (xk,pk)K
k=1 be
a consumption dataset. Then the following are equivalent:
I) D has a locally nonsatiated strong rationalization.
II) D satisï¬es SARP.
III) There are strictly positive real numbers Uk and Î»k, for each k, such
that for all k and l,
Uk â‰¤Ul + Î»lpl Â· (xk âˆ’xl);
and further, if xk Ì¸= xl,
Uk < Ul + Î»lpl Â· (xk âˆ’xl).
IV) D has a continuous, strictly concave, and strictly monotonic strong
rationalization u : X â†’R.
Proof. The proof that (II) â‡’(III) goes along familiar lines. Construct the
matrix B as in Afriatâ€™s Theorem, but only include in A the pairs (i,j) with
pi Â· (xj âˆ’xi) â‰¤0 (as we remarked above, this can also be done in the proof
of Afriatâ€™s Theorem). Now, partition the set A into A1 containing the pairs


--- Page 16 ---
3.2 Strong rationalization
49
(k,l) with xk = xl, and A2 containing the pairs (k,l) with xk Ì¸= xl. Now, a
vector (U,Î») = (U1,...,UK,Î»1,...,Î»K) satisï¬es the inequalities in (III) iff
B(i,j) Â· (U,Î») â‰¥0, for all (i,j) âˆˆA1, B(i,j) Â· (U,Î») > 0, for all (i,j) âˆˆA2, and
Bi Â· (U,Î») > 0 for all i.
The nonexistence of a solution to this system of inequalities implies the
existence of a vector of weights Î· such that

(i,j)âˆˆA1
Î·(i,j)B(i,j) +

(i,j)âˆˆA2
Î·(i,j)B(i,j) +
K

i=1
Î·iBi = 0
with strictly positive weights Î·i > 0 for some i, or Î·i,j > 0 for some (i,j) âˆˆA2.
If Î·i > 0 then there is j such that pi Â· (xj âˆ’xi) < 0, and the proof proceeds to
establish a cycle exactly as in the proof of Afriatâ€™s Theorem. If, instead, Î·i,j > 0
for some (i,j) âˆˆA2 then pi Â· (xj âˆ’xi) â‰¤0 and xi Ì¸= xj implies that xi â‰»R xj by
deï¬nition of âŸ¨âª°S,â‰»SâŸ©. Thus we start a cycle with a strict revealed preference
comparison, just as in the case when Î·i > 0.
The proof of (III) â‡’(IV) requires more work than in the corresponding
step of the proof of Afriatâ€™s Theorem. Let us ï¬x a solution (U,Î») of the
system (III).
Let h : Rn â†’R be a strictly convex and differentiable function such that
h(x) = 0 only at 0, and is otherwise positive with globally bounded derivative
(above and below) in all directions.5 Let Îµ > 0 be small enough such that two
criteria are satisï¬ed: in the ï¬rst place, such that
Uj < Ui + Î»ipi Â· (xj âˆ’xi) âˆ’Îµh(xj âˆ’xi)
for all xi Ì¸= xj; and in the second place, such that for all x and commodities i,
Îµâˆ‡h(x) < Î»ipi,
where â‰¤is vector inequality and âˆ‡refers to the gradient (this is possible as h
has bounded derivative in each direction and Î»ipi âˆˆRn
++).
We now deï¬ne, for each i, Ï•i : X â†’R by
Ï•i(x) = Ui + Î»ipi Â· (x âˆ’xi) âˆ’Îµh(x âˆ’xi).
Finally, we deï¬ne u : X â†’R by
u(x) = min
i Ï•i(x).
It is obvious that u is strictly concave. We claim that it also rationalizes the
data.
As a ï¬rst step, we need to ensure that it is monotonic. This follows from the
second property of Îµ above, which ensures that âˆ‡Ï•i â‰«0.
Now, we must show that u rationalizes the data. First, note that u(xi) =
Ï•i(xi) = Ui (this follows by the generalized Afriat inequalities in (III) and by
5 For example, h(x) = n
i=1 (|xi| âˆ’ln(|xi| + 1)).


--- Page 17 ---
50
Rational Demand
No smooth rationalization.
Non-linear prices: a bulk discount.
p2
p1
x1
x1 = x2
(a)
(b)
Fig. 3.4 Smooth utility and general budget sets.
the choice of Îµ). Now, suppose that pi Â· (x âˆ’xi) â‰¤0 and x Ì¸= xi. Then
u(x) â‰¤Ï•i(x) = Ui + Î»ipi Â· (x âˆ’xi) âˆ’Îµh(x âˆ’xi) < Ui = u(xi).
So u strongly rationalizes the data.
3.2.1
Smooth utility
Many economic models endow consumers with a differentiable utility, and it
is natural to use consumption data to test for differentiability. Consider data
(x1,p1),(x2,p2) as in Figure 3.4(a); it is clear that a rationalizing utility would
need to have a â€œkinkâ€ at x1. The data in Figure 3.4(a) suggest a necessary
condition for rationalization by a smooth function: that xk Ì¸= xl when pk Ì¸= pl.
This condition turns out to be the only added empirical content of smoothness,
as formalized by the following result due to Chiappori and Rochet.
Theorem 3.13
A dataset D = (xk,pk)K
k=1 is strongly rationalizable by a
smooth, strictly monotonic, and strictly concave utility u : X â†’R iff D satisï¬es
(1) SARP and (2) xk = xl iff pk = pl.
3.2.2
General budget sets
Finally, we discuss data with general budget sets. Let X be a convex set. A
dataset is now a collection (xk,Bk),k = 1,...,K, where Bk is a closed set such
that
I) the complement of Bk in X is a convex set;
II) if z /âˆˆBk and y > z, then y /âˆˆz;
III) if y > xk, then y /âˆˆBk.
A consumer facing nonlinear prices is a classical example of how such data
could be generated. For example, in the budget in Figure 3.4(b) there is a


--- Page 18 ---
3.2 Strong rationalization
51
quantity discount: good 1 costs p1 for quantities below x1 and pâ€²
1 < p1 for
quantities above.
Here (I) captures precisely the â€œquantity discountâ€ idea, while (II) is a
generalization of the monotonicity in standard budgets with linear prices.
Requirement (III) corresponds to the standard assumption that choices exhaust
all the consumerâ€™s income. A special case of this model is obtained when
there are continuous, monotone increasing, and convex functions gk such that
gk(xk) = 0 and Bk = {y âˆˆX : gk(y) â‰¤0}. It is interesting to contrast the model
with the one in Section 3.1.3.
Adapting the deï¬nitions of revealed preference, we can deï¬ne x âª°S y when
there is k such that x = xk and y âˆˆBk; and x â‰»S y when x âª°S y and x Ì¸= y. By
analogy with our previous theory, we say that the data satisfy SARP if âŸ¨âª°S,â‰»SâŸ©
is acyclic.
The following result is due to Rosa Matzkin.
Theorem 3.14
Let X be convex and bounded. A dataset is strongly
rationalizable by a strictly monotonic, and strictly concave utility iff it satisï¬es
SARP.
3.2.3
Partially observed prices and consumption
The analysis until now has assumed data on all relevant prices and con-
sumptions. This assumption may not always be reasonable. For example the
return on household labor, which can be seen as the price of leisure, may not
be observable. Similarly, consumption surveys normally ask for information
on consumption deï¬ned narrowly: supermarket purchases, purchases of
non-durables, etc. The demand for all commodities may not be observable.
We show in this section that such lack of observability leads to a serious lack
of predictive power.
Let us begin with the case of partially observed prices. Say that we have
n + m commodities. We observe the consumption of all n + m commodities,
with K data points. However, we only observe the prices corresponding to the
ï¬rst n commodities.
Formally, we say that a consumption dataset with partially observed prices
D is a collection (xk,pk), k = 1,...K, with xk âˆˆRn+m
+
and pk âˆˆRn
++. We
say that D, a consumption dataset with partially observed prices, is weakly
rationalizable if for each k = 1,...,K, there exists qk âˆˆRm
++ such that
(xk,(pk,qk)) is a consumption dataset which is weakly rationalizable.
Let xn denote the projection of x âˆˆRn+m
+
onto its ï¬rst n coordinates;
similarly deï¬ne xm to be the projection on the last m coordinates. Further,
for a consumption dataset with partially observed prices, and x âˆˆRm
++, we
let Kx = {k âˆˆ{1,...,K} : xk
m = x}.
Theorem 3.15
A consumption dataset with partially observed prices is
weakly rationalizable by a locally nonsatiated preference iff for all x âˆˆRm
++,
the set (xk
n,pk)kâˆˆKx is weakly rationalizable by a locally nonsatiated preference.


--- Page 19 ---
52
Rational Demand
Proof. If the consumption dataset with partially observed prices is weakly
rationalizable by a locally nonsatiated preference, there exist Uk, Î»k, and qk
such that for all k,l âˆˆKx, Uk â‰¤Ul + Î»l(pl,ql) Â· (xk âˆ’xl). But since xk
m = x =
xl
m, these inequalities become Uk â‰¤Ul + Î»lpl Â· (xk
n âˆ’xl
n), so that the Afriat
inequalities are satisï¬ed for (xk
n,pk)kâˆˆKx.
Conversely, suppose that each (xk
n,pk)kâˆˆKx is weakly rationalizable by a
locally nonsatiated preference. Let q âˆˆRm
++ be such that xk
m Ì¸= xl
m implies
q Â· xk
m Ì¸= q Â· xl
m; simply choose q to be not perpendicular to any of the vectors
{xk
m âˆ’xl
m}kÌ¸=l.
Now, for each k, let Î¼k > 0 be large enough so that
Î¼k >
max
{l:xlmÌ¸=xkm}

pk Â· (xl
n âˆ’xk
n)
q Â· (xkm âˆ’xlm) ,1

.
Let qk = Î¼kq. Let us deï¬ne our pair âŸ¨âª°R,â‰»RâŸ©as usual, for the consumption
dataset (xk,(pk,qk)). There can be no cycles within Kx for any x, by hypothesis.
We now claim that for k,l for which xk
m Ì¸= xl
m, qÂ·xk
m > qÂ·xl
m implies that xl âª°R xk
is false. To see this, ql Â·(xl
m âˆ’xk
m) < pl Â·(xk
n âˆ’xl
n), so that (pl,ql)Â·xl < (pl,ql)Â·xk.
Now, we claim that there are no âŸ¨âª°R,â‰»RâŸ©cycles. Suppose for a contradiction
that there is a cycle, x1 âª°R x2 âª°R ... âª°R xK â‰»R x1. Then we claim that for all
k, q Â· xk
m â‰¥q Â· xk+1
m , where addition is modulo K as usual. If not then there is
a k for which the inequality is reversed. In this case, we must have xk
m Ì¸= xk+1
m
and q Â· xk+1
m
> q Â· xk
m, from which we obtain from the previous paragraph that
xk âª°R xk+1 is false, which is a contradiction. Consequently, we have that for all
k, qÂ·xk
m = qÂ·xk+1
m , from which we obtain by the assumption on q that xk
m = xk+1
m .
This implies that all elements of the cycle must lie in a single Kx, which was
assumed false. Hence there is no âŸ¨âª°R,â‰»RâŸ©cycle.
Importantly, Theorem 3.15 demonstrates that if demand for commodities
whose prices are unobserved is always distinct across observations, preference
maximization implies no additional conditions.
We can also ask what happens when there is unobserved consumption. It
turns out that as soon as there is some commodity whose consumption we
cannot observe, there is no empirical content to preference maximization. A
consumption dataset with partially observed consumption D is a collection
(xk,pk) for k = 1,...,K, where each xk âˆˆRn
+, and each pk âˆˆRn+m
++ .
Theorem 3.16
Suppose that m â‰¥1. Then for any consumption dataset with
partially observed consumption, there exists yk âˆˆRm
+ for which ((xk,yk),pk),
k = 1,...,K, is a consumption dataset which is weakly rationalizable by a
locally nonsatiated preference.
Proof. The indices naturally order observations. We assume zero consumption
for all commodities with index at least as high as n + 2. Consumption of
commodity n + 1 is deï¬ned ï¬rst for k = 1 as 0. Inductively it is deï¬ned to
be large enough so that {x : pk Â· x â‰¤pk Â· (xk
n,xk
n+1,0,...,0)} is nested in the


--- Page 20 ---
3.3 Revealed preference graphs
53
relative interior of {x : pk+1 Â· x â‰¤pk+1 Â· (xk+1
n
,xk+1
n+1,0,...,0)}. To do so, note
that the set {x : pk Â· x â‰¤pk Â· (xk
n,xk
n+1,0,...,0)} is compact, so we can maximize
pk+1 Â· x on it, and let the maximum value of this be w. Choose xk+1
n+1 so that
pk+1 Â· (xk+1
n
,xk+1
n+1,0,...,0) is greater than w, and set yk = (xk+1
n+1,0,...,0). By
this construction, we have that for k > l, pk Â· (xk,yk) > pk Â· (xl,yl). Conversely,
suppose that pk Â· (xk,yk) > pk Â· (xl,yl). Clearly l Ì¸= k. If l > k, then by
construction, pk Â· (xl,yl) > pk Â· (xk,yk); since yl was chosen so that (xl,yl) is
not in the set {x : pk Â· x â‰¤pk Â· (xk,yk)}. So k > l iff pk Â· (xk,yk) > pk Â· (xl,yl).
Consequently, the data ((xk,yk),pk) can be rationalized by a locally nonsatiated
preference.
Theorems 3.15 and 3.16 allow ï¬‚exibility in choosing the observed wealth,
which is something which, in the setup of this chapter, has been taken to be
equal to expenditure (hence determined, or observed). If wealth is observable,
these results break down. It remains an open question to characterize the
empirical content of preference maximization with only partially observed
prices and/or consumption, especially when wealth can be observed. Results
exist for the one-dimensional case where bounds are put on consumption in
Theorem 3.16.
Finally, we note that empirical studies of consumption avoid the conclusion
of Theorem 3.16 by assuming that preferences are separable. If one studies,
for example, supermarket purchases, then one assumes that goods which are
not purchased in a supermarket are separable from the ones that are. This
means that if an agent conforms to the theory, she will have a budget for the
supermarket. One can then treat the problem of choosing optimal consumption
in the supermarket separately from the rest of the agentâ€™s consumption
decisions. Separability is treated in 4.2.2.
3.3
REVEALED PREFERENCE GRAPHS
Finally, we investigate here a question which is related speciï¬cally to the
structure of linear budget sets. Return to the notion of data introduced in 3.1:
a collection (xk,pk), k = 1,...K, with K â‰¥1 an integer, xk âˆˆX and pk âˆˆRn
++.
The integer K is the cardinality of the dataset.
For a consumption dataset D of cardinality K, we can deï¬ne the revealed
preference graph âŸ¨âŠµ,â–·âŸ©on {1,...,K} by i âŠµj if pi Â· xi â‰¥pi Â· xj and i â–·j if
pi Â· xi > pi Â· xj. We say that âŸ¨âŠµ,â–·âŸ©is the revealed preference graph deï¬ned
by D.
The following simple result states that there are no a priori restrictions on
which order pairs can be revealed preference graphs.
Theorem 3.17
Let âŸ¨âŠµ,â–·âŸ©be an order pair in which âŠµis a reï¬‚exive binary
relation and â–·is an irreï¬‚exive binary relation on {1,...,K}. Then there exists
X and a consumption dataset D on X of cardinality K for which âŸ¨âŠµ,â–·âŸ©is the
corresponding revealed preference graph.


--- Page 21 ---
54
Rational Demand
Proof. Suppose âŠµis reï¬‚exive. Let X = RK
+ and let xi = 1i; the unit vector in
dimension i. For each i and j, set
pi
j =
â§
âªâ¨
âªâ©
1/2
if i â–·j
1
if i âŠµj and not i â–·j
2
if not i âŠµj
It is easy to verify that D so deï¬ned has âŸ¨âŠµ,â–·âŸ©as its revealed preference order
pair.
Theorem 3.17 allows ï¬‚exibility in choosing consumption space. If consump-
tion space is ï¬xed, then the question of which order pairs can be revealed
preference graphs remains open. We will encounter phenomena of this type
several times; see for example Theorem 9.1 and Theorem 11.2.
Theorem 3.18
For any X âŠ†Rn
+ in which n â‰¥2, for any K â‰¥1, the following
order pairs are revealed preference graphs on {1,...,K}:
I) âŸ¨= âˆªÌ¸=,Ì¸=âŸ©
II) âŸ¨=,âˆ…âŸ©
In the ï¬rst graph of Theorem 3.18, every observation is strictly revealed
preferred to every other observation.
Proof. To see that the ï¬rst is a revealed preference graph, let S be the unit
sphere in Rn. Fix arbitrary p1, . . . , pK âˆˆRn
++ such that pi and pj are not collinear
whenever i Ì¸= j, deï¬ne xi = argmaxS pi Â· x. It is easy to verify that this data has
âŸ¨= âˆªÌ¸=,Ì¸=âŸ©as its revealed preference graph. (Note that any smooth convex
set with nonempty interior intersecting the strictly positive orthant will work
in place of S, so long as we can choose pi so to have unique and distinct
maximizers in the positive orthant.)
Showing that âŸ¨=,âˆ…âŸ©is a revealed preference graph follows a similar
construction, instead letting P = {x âˆˆRn
+ : xi â‰¥1}. Choose arbitrary pi (as
long as pi and pj are not collinear when i Ì¸= j) and let xi = argminP pi Â· x.
Similarly, there is nothing particularly special about the set P.
3.4
CHAPTER REFERENCES
Samuelson (1938) introduced the idea of revealed preferences, and formulated
the weak axiom of revealed preference. Little (1949) and Samuelson (1948)
showed how to construct indifference curves from revealed preference in the
two-commodity case. Houthakker (1950) proved a version of Theorem 3.1,
the ï¬rst characterization of the empirical content of rational consumption.
Houthakkerâ€™s condition was stated for single-valued demand, and was
equivalent to the condition we here call SARP. Related are the papers by


--- Page 22 ---
3.4 Chapter references
55
Newman (1960) and Stigum (1973).6 Samuelson (1950) coined the phrase
â€œstrong axiom of revealed preference;â€ however, the concept he attributes
to Houthakker is slightly different from Houthakkerâ€™s actual contribution.
Speciï¬cally, Samuelson required that the strong revealed preference pair be
quasi-acyclic. There seems to be no general consensus on the meaning of
SARP in the literature; for more on this, see Suzumura (1977). We should
also mention the contribution of Mas-Colell (1978), which can be viewed
as an identiï¬cation result for demand functions satisfying certain revealed
preference axioms.
Marcel Richter, in two important survey articles (Richter, 1971 and
Richter, 1979) presents a uniï¬ed view of revealed preference, discussing the
commonalities and differences between the material in Chapters 2 and 3. In
particular, Richter (1979) accounts for how the duality between choices and
budgets translates into revealed preference theory. Richter also covers the
relation to the question of integrability of demand, which is out of the scope of
our book.
The observation in Remark 3.3 is due to Polisson and Quah (2013).
Theorem 3.4 is due to Rose (1958), though the result was conjectured earlier
by Hicks (1956, pp. 52â€“54).7 An example of a well-deï¬ned, continuous, almost
everywhere differentiable demand function satisfying WARP and not GARP
is given in Gale (1960a) (see also Hicks, 1956, pp. 110â€“111). Kihlstrom,
Mas-Colell, and Sonnenschein (1976) provide a theory of such demand
functions. WARP is the absence of cycles of length two: a natural conjecture
is that absence of cycles of length n would sufï¬ce for rationalizability in
n-dimensional space. Kamiya (1963) gives an example of ï¬nite data for three
consumption goods which exhibits no cycles of length two or three, but which
is not rationalizable. Shafer (1977) establishes that this non-equivalence is
robust. Shafer works with demand functions (not ï¬nite data) and shows that for
three commodities, one must require absence of cycles of all possible lengths,
by exhibiting, for any n, single-valued demand functions which exhibit no
cycles of length n, but which are not rationalizable. Peters and Wakker (1994,
1996) discuss this result for environments with more than three commodities;
see also John (1997). Finally, a recent investigation into these ideas is Heufer
(2007).
Afriatâ€™s Theorem appeared ï¬rst in Afriat (1967), but was popularized by
Hal Varian in a collection of papers ((1982; 1983a; 1985)). Recently, Fostel,
Scarf, and Todd (2004) and Chung-Piaw and Vohra (2003) provided new
proofs of Afriatâ€™s Theorem. Our proof in 3.1.1 is different from these, and
follows basically the argument by Matzkin and Richter (1991). The ï¬rst
6 Uzawa (1960a, 1971) investigates demand functions satisfying WARP and a regularity
condition. See also Bossert (1993). A series of papers investigates a related â€œcontinuousâ€
version of an acyclicity condition; see Ville (1946); Ville and Newman (1951â€“1952); Hurwicz
and Richter (1979).
7 See also Newman (1955); Houthakker (1957); Newman (1960), Blackorby, Bossert, and
Donaldson (1995), and Banerjee and Murphy (2006).


--- Page 23 ---
56
Rational Demand
linear-programming-style proofs of Afriatâ€™s Theorem are due to Diewert
(1973). The argument using linear combinations of rows in the proof is a form
of the PoincarÂ´eâ€“Veblenâ€“Alexander Theorem (see Berge, 2001; the theorem is
attributed to early contributors to the mathematical discipline of topology, i.e.
PoincarÂ´e, 1895; Veblen and Alexander, 1912â€“1913). The constructive proof of
Afriatâ€™s Theorem in 3.1.2 is taken from Varian (1982).
The recent paper by Reny (2014) considers inï¬nite datasets, and shows
that GARP is necessary and sufï¬cient for the existence of a quasiconcave
rationalization. Renyâ€™s result uniï¬es the approaches based on ï¬nite datasets
and demand functions. It is noteworthy that an inï¬nite dataset satisfying GARP
may not be rationalizable by a concave utility, only a quasiconcave one. The
theorem of Reny also gives a particularly simple proof of a weak version of
Afriatâ€™s Theorem (one ensuring a quasiconcave rationalization) for ï¬nite data.
Sondermann (1982) provides a sufï¬cient condition ensuring representation by
an upper semicontinuous (closed upper contour sets) utility.
Necessary and sufï¬cient conditions for the existence of Î»k such that xk â†’
Î»kpk is monotone are presented in John (2001), where it is also shown that
the model is equivalent to rationalization by a nontransitive preference with a
certain type of â€œutilityâ€ rationalization which has a certain convexity property.
Probably the ï¬rst paper to study a version of Afriatâ€™s Theorem for nonlinear
budget sets is Yatchew (1985), who investigates necessary and sufï¬cient
conditions for convex utility maximization on ï¬nite unions of polyhedra in
the form of inequalities. Theorem 3.8 is from Forges and Minelli (2009).
Forges and Minelli also present a stronger result, where if the functions gk
are quasiconvex and differentiable then there is a concave rationalization,
if there is a rationalization. Cherchye, Demuynck, and De Rock (2014)
build on this result, establishing a characterization of datasets which are
weakly rationalizable by quasiconcave, locally nonsatiated, and continuous
preferences on arbitrary budget sets which are closed and satisfy free
disposability.
Theorem 3.12 is due to Matzkin and Richter (1991). Matzkin and Richter
clarify the notions of weak and strong rationalizability, and put the previous
work on revealed preference in this context. Theorem 3.13 is due to Chiappori
and Rochet (1987). Matzkin and Richter (1991) also present a result on smooth
rationalization, in the spirit of Theorem 3.13. The result on general budget sets
in Theorem 3.14 is due to Matzkin (1991).
Theorems 3.15 and 3.16 are due to Varian (1988a); the case of m = 1 is
established there.
Theorem 3.17 can be found in Deb and Pai (2014), as well as the ï¬rst part
of Theorem 3.18, though these results are implicit in other works.
Finally, we have not discussed stochastic choice in demand theory:
See the papers by Bandyopadhyay, Dasgupta, and Pattanaik (1999) and
Bandyopadhyay, Dasgupta, and Pattanaik (2004).
